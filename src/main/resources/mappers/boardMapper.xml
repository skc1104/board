<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mabatis.org/DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.skchoi.board.boardMapper">
	<select id="getBoardList" parameterType="com.skchoi.board.form.BoardForm" resultType="com.skchoi.board.dto.BoardDto">
		SELECT BOARD_SEQ
			, BOARD_RE_REF
			, BOARD_RE_LEV
			, BOARD_RE_SEQ
			, BOARD_WRITER
			, BOARD_SUBJECT
			, BOARD_CONTENT
			, BOARD_HITS
			, DEL_YN
			, INS_USER_ID
			, CAST( DATE_FORMAT( INS_DATE, '%Y-%m-%d %H:%i:%s' ) As Char(19)) As INS_DATE
			, UPD_USER_ID
			, CAST( DATE_FORMAT( UPD_DATE, '%Y-%m-%d %H:%i:%s' ) As Char(19)) As UPD_DATE
		FROM board.TB_BOARD
		ORDER BY BOARD_SEQ DESC
	</select>
	
	<delete id="updateBoardHits" parameterType="com.skchoi.board.form.BoardForm">
		UPDATE BOARD.RB_BOARD
		SET BOARD_HITS = BOARD_HITS + 1
			, UPD_USER_ID = 'NOMEMBER'
			, UPD_DATE = NOW()
		WHERE BOARD_SEQ = #{board_seq}
	</delete>
	
	<select id="getBoardDetail" parameterType="com.skchoi.board.form.BoardForm" resultType="com.skchoi.board.dto.BoardDto">
		SELECT BOARD_SEQ
			, BOARD_RE_REF
			, BOARD_RE_LEV
			, BOARD_RE_SEQ
			, BOARD_WRITER
			, BOARD_SUBJECT
			, BOARD_CONTENT
			, BOARD_HITS
			, DEL_YN
			, INS_USER_ID
			, CAST( DATE_FORMAT( INS_DATE, '%Y-%m-%d %H:%i:%s' ) As Char(19)) As INS_DATE
			, UPD_USER_ID
			, CAST( DATE_FORMAT( UPD_DATE, '%Y-%m-%d %H:%i:%s' ) As Char(19)) As UPD_DATE
		FROM board.TB_BOARD
		WHERE BOARD_SEQ = #{board_seq}
	</select>
	
	<insert id="insertBoard" parameterType="com.skchoi.board.form.BoardForm">
		INSERT INTO BOARD.TB_BOARD
		(
			  BOARD_RE_REF
			, BOARD_RE_LEV
			, BOARD_RE_SEQ
			, BOARD_WRITER
			, BOARD_SUBJECT
			, BOARD_CONTENT
			, INS_USER_ID
			, INS_DATE
			, UPD_USER_ID
			, UPD_DATE
		)
		VALUES
		(
			  0
			, 0
			, 0
			, #{board_writer}
			, #{board_subject}
			, #{board_content}
			, 'NOMEMBER'
			, NOW()
			, 'NOMEMBER'
			, NOW()
		)
	</insert>
	
	<delete id="deleteBoard" parameterType="com.skchoi.board.form.BoardForm">
		DELETE FROM BOARD.TB_BOARD
		WHERE BOARD_SEQ = #{boaard_seq}
	</delete>
</mapper>
